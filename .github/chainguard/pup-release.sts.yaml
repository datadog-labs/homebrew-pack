# Trust policy for pup release workflow to push Homebrew formulas
issuer: https://token.actions.githubusercontent.com

# Allow releases from main branch of pup only
subject_pattern: repo:DataDog/pup:ref:refs/heads/main

# Defense-in-depth: additional claim validation
claim_pattern:
  event_name: push
  ref: refs/heads/main
  ref_protected: "true"
  job_workflow_ref: DataDog/pup/\.github/workflows/release\.yml@refs/heads/main

# Grant write access to push formula updates
permissions:
  contents: write
